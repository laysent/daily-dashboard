(window.webpackJsonp=window.webpackJsonp||[]).push([[1],[,,,,,,,,,function(t,e,n){t.exports=n.p+"static/media/thunderstorm.58ebab15.svg"},function(t,e,n){t.exports=n.p+"static/media/heavy-rain.caa6ed2b.svg"},function(t,e,n){t.exports=n.p+"static/media/light-rain.06661442.svg"},function(t,e,n){t.exports=n.p+"static/media/snow.20ff1fe1.svg"},function(t,e,n){t.exports=n.p+"static/media/clear.a835ff7f.svg"},function(t,e,n){t.exports=n.p+"static/media/cloud.142dc879.svg"},function(t,e,n){t.exports=n.p+"static/media/bus.e574b9b3.svg"},,,function(t,e,n){t.exports=n.p+"static/media/bilibili.a13a87fb.svg"},function(t,e,n){t.exports=n.p+"static/media/eating.f3642dc9.svg"},function(t,e,n){t.exports=n.p+"static/media/loading.2d1490eb.svg"},function(t,e,n){t.exports=n.p+"static/media/play.68170af3.svg"},function(t,e,n){t.exports=n.p+"static/media/pause.95cf549e.svg"},function(t,e,n){t.exports=n.p+"static/media/wallet.976a3ad5.svg"},function(t,e,n){t.exports=n.p+"static/media/umbrella.934ffe5a.svg"},function(t,e,n){t.exports=n.p+"static/media/mask.c11d3a66.svg"},function(t,e,n){t.exports=n.p+"static/media/left.4d5ba73f.svg"},function(t,e,n){t.exports=n.p+"static/media/right.064b03a6.svg"},function(t,e,n){t.exports=n.p+"static/media/check.47e2c3ee.svg"},,,,function(t,e,n){t.exports=n(45)},,,,,,function(t,e,n){},,function(t,e,n){},,,,,function(t,e,n){"use strict";n.r(e);var a,r,i=n(0),o=n.n(i),s=n(17),c=n.n(s),u=(n(38),n(2)),l=n(3),p=n(7),d=n(6),f=n(8),m=(n(40),n(1)),h=n.n(m),b=n(4),g=n(5),v=n(9),y=n.n(v),w=n(10),x=n.n(w),j=n(11),O=n.n(j),k=n(12),N=n.n(k),E=n(13),C=n.n(E),S=n(14),I=n.n(S),D=n(15),R=n.n(D),_=n(18),P=n.n(_),L=n(19),A=n.n(L);!function(t){t[t.thunderstorm=0]="thunderstorm",t[t.heavyRain=1]="heavyRain",t[t.lightRain=2]="lightRain",t[t.snow=3]="snow",t[t.clear=4]="clear",t[t.cloud=5]="cloud",t[t.bus=6]="bus",t[t.video=7]="video",t[t.eating=8]="eating"}(r||(r={}));var q,W,J,M=(a={},Object(g.a)(a,r.thunderstorm,y.a),Object(g.a)(a,r.heavyRain,x.a),Object(g.a)(a,r.lightRain,O.a),Object(g.a)(a,r.snow,N.a),Object(g.a)(a,r.clear,C.a),Object(g.a)(a,r.cloud,I.a),Object(g.a)(a,r.bus,R.a),Object(g.a)(a,r.video,P.a),Object(g.a)(a,r.eating,A.a),a),T=function(t){function e(){return Object(u.a)(this,e),Object(p.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(f.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this.props,e=t.color,n=t.icon,a=t.title,r=t.subtitle,i=t.loading,s=t.link,c=t.children;return o.a.createElement("section",{style:{backgroundColor:e}},!i&&o.a.createElement("a",{href:s,target:"_blank",className:"center"},n&&o.a.createElement("img",{className:"icon",alt:"icon",src:M[n]}),o.a.createElement("h1",null,a),o.a.createElement("h3",null,r)),c)}}]),e}(i.Component);function B(t){return U.apply(this,arguments)}function U(){return(U=Object(b.a)(h.a.mark(function t(e){var n,a,r,i;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e===q.toCompany?"work":"home",a=Date.now(),t.next=4,fetch("https://laysent-daily-transport.now.sh/?direction=".concat(n,"&timestamp=").concat(a,"&lat=30.29365&lng=120.16142"));case 4:return r=t.sent,t.next=7,r.json();case 7:return i=t.sent,t.abrupt("return",i);case 9:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function F(t){return+new Date-+t<864e5}function H(t,e){var n=0,a=null;return a=window.requestAnimationFrame(function r(i){i-n>=e&&(t(),n=i),a=window.requestAnimationFrame(r)}),t(),function(){null!==a&&(window.cancelAnimationFrame(a),a=null)}}function G(){var t=(new Date).getHours();return t<7?W.night:t<11?W.morning:t<14?W.noon:t<18?W.afternoon:t<22?W.evening:W.night}!function(t){t[t.toCompany=0]="toCompany",t[t.fromCompany=1]="fromCompany"}(q||(q={})),(J=W||(W={}))[J.morning=0]="morning",J[J.noon=1]="noon",J[J.afternoon=2]="afternoon",J[J.evening=3]="evening",J[J.night=4]="night";var Y,$,z=/iphone/i.test(navigator.userAgent),K=n(20),Q=n.n(K),V=n(21),X=n.n(V),Z=n(22),tt=n.n(Z),et=n(23),nt=n.n(et),at=3e4,rt=function(t){function e(t){var n;Object(u.a)(this,e),(n=Object(p.a)(this,Object(d.a)(e).call(this,t))).state=void 0,n.stop=null,n.getBusDetails=Object(b.a)(h.a.mark(function t(){var e,a,r;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((e=G())!==W.night){t.next=4;break}return n.setState({buses:[],fetching:!1}),t.abrupt("return");case 4:return a=e===W.morning?q.toCompany:q.fromCompany,n.setState({fetching:!0}),t.next=8,B(a);case 8:r=t.sent,n.setState({buses:r.map(function(t){return Math.round(t/60)}),fetching:!1});case 10:case"end":return t.stop()}},t,this)})),n.onStatusChange=function(){var t=!n.state.paused;t?(null!==n.stop&&n.stop(),n.stop=null):n.stop=H(n.getBusDetails,at),n.setState({paused:t})};var a=G(),r=a===W.morning||a===W.evening;return n.state={buses:[],fetching:!1,paused:!r},n}return Object(f.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){this.state.paused?this.getBusDetails():this.stop=H(this.getBusDetails,at)}},{key:"componentWillUnmount",value:function(){null!==this.stop&&this.stop()}},{key:"render",value:function(){var t=this.state.buses,e="Go Texi";return t.length>0?e="".concat(t[0]," min"):this.state.fetching&&(e="-"),o.a.createElement(T,{color:"#f9d171",title:e,subtitle:t.length>1?"".concat(t.slice(1).map(function(t){return"".concat(t," min")}).join("/")):"",icon:r.bus,loading:!1},this.state.fetching?o.a.createElement("img",{src:Q.a,alt:"fetching",className:"small-icon right-top spinning"}):o.a.createElement("button",{className:"icon-button right-top",onClick:this.onStatusChange},o.a.createElement("img",{src:this.state.paused?X.a:tt.a,alt:this.state.paused?"play":"pause",className:"small-icon"})),z&&o.a.createElement("a",{href:"alipayqr://platformapi/startapp?saId=200011235",target:"_blank",className:"icon-button left-top"},o.a.createElement("img",{src:nt.a,alt:"wallet",className:"small-icon"})))}}]),e}(i.PureComponent);!function(t){t[t.thunderstorm=0]="thunderstorm",t[t.heavyRain=1]="heavyRain",t[t.lightRain=2]="lightRain",t[t.snow=3]="snow",t[t.clear=4]="clear",t[t.cloud=5]="cloud",t[t.bus=6]="bus"}($||($={}));var it=(Y={},Object(g.a)(Y,$.thunderstorm,y.a),Object(g.a)(Y,$.heavyRain,x.a),Object(g.a)(Y,$.lightRain,O.a),Object(g.a)(Y,$.snow,N.a),Object(g.a)(Y,$.clear,C.a),Object(g.a)(Y,$.cloud,I.a),Object(g.a)(Y,$.bus,R.a),Y),ot=(i.Component,n(24)),st=n.n(ot),ct=n(25),ut=n.n(ct);function lt(t){return t>=200&&t<=232?$.thunderstorm:t>=300&&t<=321?$.heavyRain:t>=500&&t<=531?$.lightRain:t>=600&&t<=622?$.snow:800===t?$.clear:t>=801&&t<=804?$.cloud:$.clear}function pt(){return dt.apply(this,arguments)}function dt(){return(dt=Object(b.a)(h.a.mark(function t(){var e,n,a;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return"https://api.openweathermap.org/data/2.5/forecast/daily?lat=30.29365&lon=120.16142&units=metric&cnt=1&appid=d94bcd435b62a031771c35633f9f310a",t.next=3,fetch("https://api.openweathermap.org/data/2.5/forecast/daily?lat=30.29365&lon=120.16142&units=metric&cnt=1&appid=d94bcd435b62a031771c35633f9f310a");case 3:return e=t.sent,t.next=6,e.json();case 6:return n=t.sent,a=n.list[0].temp,t.abrupt("return",{temperature:a,icon:lt(n.list[0].weather[0].id),rainy:n.list[0].weather.some(function(t){var e=lt(t.id);return e===$.lightRain||e===$.heavyRain})});case 9:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function ft(){return mt.apply(this,arguments)}function mt(){return(mt=Object(b.a)(h.a.mark(function t(){var e,n;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return"https://api.waqi.info/feed/@722/?token=877232d674043e76c5ea9037b8772e1aa4dbd702",t.next=3,fetch("https://api.waqi.info/feed/@722/?token=877232d674043e76c5ea9037b8772e1aa4dbd702");case 3:return e=t.sent,t.next=6,e.json();case 6:return n=t.sent,t.abrupt("return",n.data);case 8:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}var ht=function(t){function e(){var t,n;Object(u.a)(this,e);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(p.a)(this,(t=Object(d.a)(e)).call.apply(t,[this].concat(r)))).state={weather:{loading:!0,title:"",subtitle:"",rainy:!1,icon:$.clear},air:{loading:!0,aqi:0}},n}return Object(f.a)(e,t),Object(l.a)(e,[{key:"getWeather",value:function(){var t=Object(b.a)(h.a.mark(function t(){var e;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,pt();case 2:e=t.sent,this.setState({weather:{loading:!1,title:(new Date).getHours()<12?e.temperature.morn:e.temperature.eve+" \xb0 C",subtitle:"".concat(e.temperature.night," ~ ").concat(e.temperature.day,"  \xb0 C"),rainy:e.rainy,icon:e.icon}});case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"getAir",value:function(){var t=Object(b.a)(h.a.mark(function t(){var e;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ft();case 2:e=t.sent,this.setState({air:{loading:!1,aqi:e.aqi}});case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.getWeather(),this.getAir()}},{key:"render",value:function(){return o.a.createElement(T,Object.assign({color:"#38c9ba"},this.state.weather),this.state.weather.rainy&&o.a.createElement("img",{src:st.a,alt:"bring umbrella",className:"small-icon left-bottom"}),!this.state.air.loading&&o.a.createElement("div",{className:"right-bottom"},Array.from({length:Math.floor(this.state.air.aqi/50)}).map(function(t,e){return o.a.createElement("img",{src:ut.a,alt:"air condition icon",className:"small-icon",key:e})})))}}]),e}(i.PureComponent);function bt(){return gt.apply(this,arguments)}function gt(){return(gt=Object(b.a)(h.a.mark(function t(){var e,n;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://cors-anywhere.herokuapp.com/http://bangumi.bilibili.com/web_api/timeline_global");case 2:return e=t.sent,t.next=5,e.json();case 5:return n=t.sent,t.abrupt("return",n);case 7:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function vt(t,e){return yt.apply(this,arguments)}function yt(){return(yt=Object(b.a)(h.a.mark(function t(e,n){return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t,a){var r=document.createElement("script"),i=document.createElement("div");i.style.display="none",window.youku_callback=function(o){if(o.error)return a(o);var s=o.html;i.innerHTML=s,document.body.appendChild(i);var c=Array.from(i.querySelectorAll(".p-panels ul li")).map(function(t){var a=t.querySelector("a");if(!a||!t.firstChild)throw new Error("failed to parse structure");var r=new URL(a.href),i=r.origin+r.pathname,o=t.firstChild.childNodes[0].textContent||"",s=a.textContent||"";return{date:0,href:i,episode:"#".concat(o," ").concat(s),episodeNum:+o,title:n,seasonId:e,source:"Youku"}});delete window.youku_callback,document.body.removeChild(i),document.body.removeChild(r),t(c)},r.src="https://list.youku.com/show/module?id=".concat(e,"&tab=showInfo&callback=youku_callback"),r.type="text/javascript",document.body.appendChild(r)}));case 1:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function wt(){return xt.apply(this,arguments)}function xt(){return(xt=Object(b.a)(h.a.mark(function t(){var e,n,a,r,i,o,s,c,u;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,bt();case 2:return e=t.sent,n=e.result,a=n.findIndex(function(t){return 1===t.is_today}),r=n.slice(0,a+1),i=n.slice(a),o=i.find(function(t){return t.seasons.findIndex(function(t){return 0===t.is_published})>=0}),s=r.map(function(t){return t.seasons.filter(function(t){return 1===t.is_published}).map(function(t){var e=t.pub_index,n=/\u7b2c([\d.]+)\u8bdd/.exec(e),a=0;return n&&(a=+n[1]),{date:1e3*t.pub_ts,episode:e,title:t.title,seasonId:t.season_id,episodeNum:a,href:"https://m.bilibili.com/bangumi/play/ep".concat(t.ep_id),source:"Bilibili"}})}).reduce(function(t,e){return t.concat(e)},[]),c=0,o&&(u=o.seasons.find(function(t){return 0===t.is_published}),c=1e3*u.pub_ts),t.abrupt("return",{videos:s,nextUpdateTime:c});case 12:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}var jt=n(26),Ot=n.n(jt),kt=n(27),Nt=n.n(kt),Et=n(28),Ct=n.n(Et);function St(t){return It.apply(this,arguments)}function It(){return(It=Object(b.a)(h.a.mark(function t(e){var n,a,r,i,o,s;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=JSON.parse(localStorage.getItem("bilibili-videos")||'{"nextUpdateTime":0,"videos":[]}'),a=n.nextUpdateTime<Date.now(),t.next=4,a?wt():Promise.resolve(n);case 4:return r=t.sent,i=r.videos,a&&localStorage.setItem("bilibili-videos",JSON.stringify(r)),o=JSON.parse(localStorage.getItem("bilibili")||"{}"),s=i.filter(function(t){var n=t.seasonId;return e.some(function(t){return t.id===n})}).filter(function(t){var e=t.seasonId;return(o[e]||0)<t.episodeNum}),t.abrupt("return",s);case 10:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function Dt(t){return Rt.apply(this,arguments)}function Rt(){return(Rt=Object(b.a)(h.a.mark(function t(e){var n,a;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(e.map(function(t){return vt(t.id,t.name)}));case 2:return n=t.sent,a=JSON.parse(localStorage.getItem("youku")||"{}"),t.abrupt("return",n.map(function(t,n){var r=e[n].id,i=a[r]||0;return t.filter(function(t){return t.episodeNum>i})}).reduce(function(t,e){return t.concat(e)},[]));case 5:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}var _t=function(t){function e(){var t,n;Object(u.a)(this,e);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(p.a)(this,(t=Object(d.a)(e)).call.apply(t,[this].concat(r)))).state={watchList:[],index:0},n.onNext=function(){n.setState({index:n.state.index+1})},n.onPrevious=function(){n.setState({index:n.state.index-1})},n.onWatched=function(){var t=n.state.watchList[n.state.index],e=t.source.toLowerCase(),a=JSON.parse(localStorage.getItem(e)||"{}");a[t.seasonId]=t.episodeNum,localStorage.setItem(e,JSON.stringify(a)),n.getPendingWatchList()},n}return Object(f.a)(e,t),Object(l.a)(e,[{key:"getPendingWatchList",value:function(){var t=Object(b.a)(h.a.mark(function t(){var e,a;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.e(0).then(n.bind(null,46)).then(function(t){return t.default.videos});case 2:return e=t.sent,t.next=5,Promise.all([St(e.filter(function(t){return"bilibili"===t.source})),Dt(e.filter(function(t){return"youku"===t.source}))]);case 5:t.t0=function(t,e){return t.concat(e)},t.t1=[],t.t2=function(t,n){var a=F(new Date(t.date)),r=F(new Date(n.date));if(a&&!r)return-1;if(!a&&r)return 1;var i=e.findIndex(function(e){return e.id===t.seasonId}),o=e.findIndex(function(t){return t.id===n.seasonId});return i<o?-1:i>o?1:t.episodeNum>n.episodeNum?1:-1},a=t.sent.reduce(t.t0,t.t1).sort(t.t2),this.setState({watchList:a,index:0});case 10:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.getPendingWatchList()}},{key:"render",value:function(){var t=this.state.watchList[this.state.index],e=!!t,n=this.state.index>0,a=this.state.index<this.state.watchList.length-1;return o.a.createElement(T,{color:"#6994e3",title:e?t.source:"-",subtitle:e?t.title:"",icon:r.video,loading:!1,link:e?t.href:void 0},n&&o.a.createElement("button",{className:"icon-button left-top",onClick:this.onPrevious},o.a.createElement("img",{src:Ot.a,alt:"previous",className:"small-icon"})),a&&o.a.createElement("button",{className:"icon-button right-top",onClick:this.onNext},o.a.createElement("img",{src:Nt.a,alt:"next",className:"small-icon"})),o.a.createElement("button",{className:"icon-button left-bottom",onClick:this.onWatched},o.a.createElement("img",{src:Ct.a,alt:"set watched",className:"small-icon"})),o.a.createElement("span",{className:"right-bottom"},e?t.episode:""))}}]),e}(i.PureComponent),Pt=n(31),Lt=n(30);var At=function(t){function e(){var t,a;Object(u.a)(this,e);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(a=Object(p.a)(this,(t=Object(d.a)(e)).call.apply(t,[this].concat(i)))).state={loading:!0,eating:[]},a.sampler=new Lt.a,a.update=function(){a.state.loading||a.setState({loading:!0}),n.e(0).then(n.bind(null,46)).then(function(t){return t.default.eating}).then(function(t){var e=G(),n=(new Date).getDay(),r=t.filter(function(t){if("undefined"===typeof t.restrict)return!0;var a=t.restrict;if("undefined"!==typeof a.day&&a.day.indexOf(n)<0)return!1;if("undefined"!==typeof a.meal)if("dinner"===a.meal){if(e!==W.evening)return!1}else if("lunch"===a.meal&&e!==W.noon)return!1;return!0});a.setState({eating:a.sampler.sample(r,5,function(t){return t.weight}),loading:!1})})},a}return Object(f.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){this.update()}},{key:"render",value:function(){var t=Object(Pt.a)(this.state.eating),e=t[0],n=t.slice(1);return o.a.createElement(T,{color:"#cc5c75",title:e&&e.name,subtitle:e&&n.map(function(t){return t.name}).join("/"),icon:r.eating,loading:this.state.loading})}}]),e}(i.PureComponent),qt=function(t){function e(t){var n;return Object(u.a)(this,e),(n=Object(p.a)(this,Object(d.a)(e).call(this,t))).state=void 0,n.updateTime=function(){document.hidden||n.setState({time:G()})},n.state={time:G()},n}return Object(f.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){document.addEventListener("visibilitychange",this.updateTime,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("visibilitychange",this.updateTime)}},{key:"render",value:function(){var t=[];switch(this.state.time){case W.morning:t=[ht,rt,_t,At];break;case W.noon:t=[At,_t,ht,rt];break;case W.afternoon:t=[ht,_t,At,rt];break;case W.evening:t=[At,rt,_t,ht];break;case W.night:t=[_t,ht,rt,At]}return o.a.createElement("main",{className:"app"},t.map(function(t){return o.a.createElement(t,{key:t.name})}))}}]),e}(i.PureComponent);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(qt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}],[[32,3,2]]]);
//# sourceMappingURL=main.fa2a48dd.chunk.js.map