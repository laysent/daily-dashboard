{"version":3,"sources":["img/weather/thunderstorm.svg","img/weather/heavy-rain.svg","img/weather/light-rain.svg","img/weather/snow.svg","img/weather/clear.svg","img/weather/cloud.svg","img/bus.svg","img/bilibili.svg","img/eating.svg","img/loading.svg","img/play.svg","img/pause.svg","img/wallet.svg","img/umbrella.svg","img/mask.svg","img/left.svg","img/right.svg","img/check.svg","cards/Card.tsx","utils/bus.ts","utils/helper.ts","cards/Section.tsx","cards/Bus.tsx","utils/weather.ts","utils/air.ts","cards/Weather.jsx","utils/video.ts","cards/Video.tsx","cards/Eating.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["module","exports","__webpack_require__","p","icons","busType","time","mapping","_mapping","Object","defineProperty","thunderstorm","heavyRain","lightRain","snow","clear","cloud","bus","video","eating","Card","_this$props","this","props","color","icon","title","subtitle","loading","link","children","react_default","a","createElement","style","backgroundColor","href","target","className","alt","src","Component","getBusDetails","_x","_getBusDetails","apply","arguments","_callee","type","direction","now","response","list","regenerator_default","wrap","_context","prev","next","toCompany","Date","fetch","concat","sent","json","abrupt","stop","isToday","date","getFullYear","getMonth","getDate","setIntervalWhenActive","fn","timespan","previous","id","window","requestAnimationFrame","callback","timestamp","cancelAnimationFrame","getTime","hour","getHours","night","morning","noon","afternoon","evening","iPhone","test","navigator","userAgent","interval","Bus","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","state","asyncToGenerator","mark","buses","helper","setState","fetching","fromCompany","map","seconds","Math","round","onStatusChange","paused","catchingBus","length","cards_Card","slice","join","onClick","play","pause","wallet","PureComponent","Section_mapping","mapWeatherIcon","weatherId","getWeatherDetails","_getWeatherDetails","weatherResult","weatherTemperature","temp","temperature","weather","rainy","some","_ref","getAirDetails","_getAirDetails","data","Weather","air","aqi","details","morn","eve","day","getWeather","getAir","assign","umbrella","Array","from","floor","_","i","mask","key","fetchBilibili","getBilibiliDetails","_getBilibiliDetails","_callee2","result","index","daysUntilToday","daysFromToday","firstDayWithUnpublishedVideo","videos","nextUpdateTime","first","_context2","findIndex","is_today","find","seasons","season","is_published","filter","episode","pub_index","matched","exec","episodeNum","pub_ts","seasonId","season_id","ep_id","reduce","acc","Video","watchList","onNext","onPrevious","onWatched","watched","JSON","parse","localStorage","getItem","setItem","stringify","getPendingWatchList","cachedDetails","shouldUpdate","Promise","all","e","then","bind","config","default","resolve","playlist","unwatched","bilibili","indexOf","sort","videoA","videoB","isVideoAToday","isVideoBToday","videoAIndex","videoBIndex","hasUnwatched","hasPrevious","hasNext","undefined","left","right","check","Eating","update","array","total","weekday","getDay","filtered","food","restrict","meal","element","random","pow","weight","b","_this$state$eating","toArray","rest","name","App","updateTime","document","hidden","addEventListener","removeEventListener","child","React","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","onUpdate","onSuccess","catch","error","ReactDOM","render","src_App_0","getElementById","URL","process","origin","contentType","headers","get","status","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.415fca45.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/thunderstorm.58ebab15.svg\";","module.exports = __webpack_public_path__ + \"static/media/heavy-rain.caa6ed2b.svg\";","module.exports = __webpack_public_path__ + \"static/media/light-rain.06661442.svg\";","module.exports = __webpack_public_path__ + \"static/media/snow.20ff1fe1.svg\";","module.exports = __webpack_public_path__ + \"static/media/clear.a835ff7f.svg\";","module.exports = __webpack_public_path__ + \"static/media/cloud.142dc879.svg\";","module.exports = __webpack_public_path__ + \"static/media/bus.e574b9b3.svg\";","module.exports = __webpack_public_path__ + \"static/media/bilibili.a13a87fb.svg\";","module.exports = __webpack_public_path__ + \"static/media/eating.f3642dc9.svg\";","module.exports = __webpack_public_path__ + \"static/media/loading.2d1490eb.svg\";","module.exports = __webpack_public_path__ + \"static/media/play.68170af3.svg\";","module.exports = __webpack_public_path__ + \"static/media/pause.95cf549e.svg\";","module.exports = __webpack_public_path__ + \"static/media/wallet.976a3ad5.svg\";","module.exports = __webpack_public_path__ + \"static/media/umbrella.934ffe5a.svg\";","module.exports = __webpack_public_path__ + \"static/media/mask.c11d3a66.svg\";","module.exports = __webpack_public_path__ + \"static/media/left.4d5ba73f.svg\";","module.exports = __webpack_public_path__ + \"static/media/right.064b03a6.svg\";","module.exports = __webpack_public_path__ + \"static/media/check.47e2c3ee.svg\";","import React, { Component } from 'react';\nimport thunderstorm from '../img/weather/thunderstorm.svg';\nimport heavyRain from '../img/weather/heavy-rain.svg';\nimport lightRain from '../img/weather/light-rain.svg';\nimport snow from '../img/weather/snow.svg';\nimport clear from '../img/weather/clear.svg';\nimport cloud from '../img/weather/cloud.svg';\nimport bus from '../img/bus.svg';\nimport video from '../img/bilibili.svg';\nimport eating from '../img/eating.svg';\n\nexport enum icons {\n  thunderstorm,\n  heavyRain,\n  lightRain,\n  snow,\n  clear,\n  cloud,\n\n  bus,\n  video,\n  eating,\n};\n\nconst mapping = {\n  [icons.thunderstorm]: thunderstorm,\n  [icons.heavyRain]: heavyRain,\n  [icons.lightRain]: lightRain,\n  [icons.snow]: snow,\n  [icons.clear]: clear,\n  [icons.cloud]: cloud,\n\n  [icons.bus]: bus,\n  [icons.video]: video,\n  [icons.eating]: eating,\n};\n\nclass Card extends Component <{ color: string, icon: icons, title: string, subtitle: string, loading: boolean, link?: string }> {\n  render() {\n    const {\n      color,\n      icon,\n      title,\n      subtitle,\n      loading,\n      link,\n      children,\n    } = this.props;\n    return (\n      <section style={{ backgroundColor: color }}>\n        {!loading && (\n          <a href={link} target=\"_blank\" className=\"center\">\n            {icon && <img className=\"icon\" alt=\"icon\" src={mapping[icon]} />}\n            <h1>{title}</h1>\n            <h3>{subtitle}</h3>\n          </a>\n        )}\n        {children}\n      </section>\n    );\n  }\n}\n\nexport default Card;\n","export enum busType {\n  toCompany,\n  fromCompany,\n};\n\nexport default async function getBusDetails(type: busType) {\n  const direction = type === busType.toCompany ? 'work' : 'home';\n  const now = Date.now();\n  const response = await fetch(`https://laysent-daily-transport.now.sh/?direction=${direction}&timestamp=${now}&lat=30.29365&lng=120.16142`);\n  const list: Array<number> = await response.json();\n  return list;\n}\n","export function isMorning() {\n  return (new Date()).getHours() < 12;\n}\n\nexport function isToday(date: Date) {\n  const now = new Date();\n  return date.getFullYear() === now.getFullYear()\n    && date.getMonth() === now.getMonth()\n    && date.getDate() === now.getDate();\n}\n\nexport function setIntervalWhenActive(fn: () => void, timespan: number) {\n  let previous = 0;\n  let id: number | null = null;\n  function callback(timestamp: number) {\n    if (timestamp - previous >= timespan) {\n      fn();\n      previous = timestamp;\n    }\n    id = window.requestAnimationFrame(callback);\n  }\n  id = window.requestAnimationFrame(callback);\n  fn();\n  return () => {\n    if (id === null) return;\n    window.cancelAnimationFrame(id);\n    id = null;\n  };\n}\n\nexport enum time {\n  morning,\n  noon,\n  afternoon,\n  evening,\n  night\n};\n\nexport function getTime() {\n  const now = new Date();\n  const hour = now.getHours();\n  if (hour < 7) return time.night;\n  if (hour < 11) return time.morning;\n  if (hour < 14) return time.noon;\n  if (hour < 18) return time.afternoon;\n  if (hour < 22) return time.evening;\n  return time.night;\n}\n\nexport const iPhone = /iphone/i.test(navigator.userAgent);\n\ninterface hasWeight {\n  weight: number;\n}\n\n/**\n * Weighted Random Sampling (2005;  Efraimidis, Spirakis)\n * [article](http://utopia.duth.gr/~pefraimi/research/data/2007EncOfAlg.pdf)\n * @param array list with all elements containing `weight` attributes - larger value, more likely to pick\n * @param total size of set for sampling\n */\nexport function weightedSampling<T extends hasWeight>(array: Array<T>, total: number): Array<T> {\n  const keys: Array<T & { key: number }> = array.map((element) => {\n    const random = Math.random();\n    const key = random ** (1 / element.weight);\n    return Object.assign({}, element, { key });\n  });\n  return keys\n    .sort((a, b) => {\n      if (a.key < b.key) return 1;\n      if (a.key > b.key) return -1;\n      return 0;\n    })\n    .slice(0, total);\n}\n","import React, { Component } from 'react';\nimport thunderstorm from '../img/weather/thunderstorm.svg';\nimport heavyRain from '../img/weather/heavy-rain.svg';\nimport lightRain from '../img/weather/light-rain.svg';\nimport snow from '../img/weather/snow.svg';\nimport clear from '../img/weather/clear.svg';\nimport cloud from '../img/weather/cloud.svg';\nimport bus from '../img/bus.svg';\n\nexport enum icons {\n  thunderstorm,\n  heavyRain,\n  lightRain,\n  snow,\n  clear,\n  cloud,\n\n  bus,\n};\n\nconst mapping = {\n  [icons.thunderstorm]: thunderstorm,\n  [icons.heavyRain]: heavyRain,\n  [icons.lightRain]: lightRain,\n  [icons.snow]: snow,\n  [icons.clear]: clear,\n  [icons.cloud]: cloud,\n\n  [icons.bus]: bus,\n};\n\nclass Section extends Component <{ className: string, icon: icons, title: string, subtitle: string, loading: boolean }> {\n  render() {\n    const {\n      className,\n      icon,\n      title,\n      subtitle,\n      loading,\n      children,\n    } = this.props;\n    return (\n      <section className={className}>\n        {!loading && (\n          <React.Fragment>\n            <img className=\"icon\" alt=\"icon\" src={mapping[icon]} />\n            <h1>{title}</h1>\n            <h3>{subtitle}</h3>\n          </React.Fragment>\n        )}\n        {children}\n      </section>\n    );\n  }\n}\n\nexport default Section;\n","import React, { PureComponent } from 'react';\nimport Card, { icons } from './Card';\nimport getBusDetails, { busType } from '../utils/bus';\nimport * as helper from '../utils/helper';\nimport loading from '../img/loading.svg';\nimport play from '../img/play.svg';\nimport pause from '../img/pause.svg';\nimport wallet from '../img/wallet.svg';\n\nconst interval = 30 * 1000;\n\nclass Bus extends PureComponent {\n  state: {\n    buses: Array<number>;\n    fetching: boolean;\n    paused: boolean;\n  }\n  constructor(props: { }) {\n    super(props);\n    const time = helper.getTime();\n    const catchingBus = time === helper.time.morning || time === helper.time.evening;\n    this.state = {\n      buses: [],\n      fetching: false,\n      paused: !catchingBus,\n    };\n  }\n  stop: (() => void) | null = null;\n  getBusDetails = async () => {\n    const time = helper.getTime();\n    if (time === helper.time.night) {\n      this.setState({\n        buses: [],\n        fetching: false,\n      });\n      return;\n    }\n    const type = time === helper.time.morning ? busType.toCompany : busType.fromCompany;\n    this.setState({\n      fetching: true,\n    });\n    const buses = await getBusDetails(type);\n    this.setState({\n      buses: buses.map(seconds => Math.round(seconds / 60)),\n      fetching: false,\n    });\n  }\n  onStatusChange = () => {\n    const paused = !this.state.paused;\n    if (paused) {\n      if (this.stop !== null) this.stop();\n      this.stop = null;\n    } else {\n      this.stop = helper.setIntervalWhenActive(this.getBusDetails, interval);\n    }\n    this.setState({\n      paused,\n    });\n  }\n  componentDidMount() {\n    if (this.state.paused) {\n      this.getBusDetails();\n    } else {\n      this.stop = helper.setIntervalWhenActive(this.getBusDetails, interval);\n    }\n  }\n  componentWillUnmount() {\n    if (this.stop !== null) this.stop();\n  }\n  render() {\n    const buses = this.state.buses;\n    let title = 'Go Texi';\n    if (buses.length > 0) title = `${buses[0]} min`;\n    else if (this.state.fetching) title = '-';\n    return (\n      <Card\n        color=\"#f9d171\"\n        title={title}\n        subtitle={buses.length > 1 ? `${buses.slice(1).map(bus => `${bus} min`).join('/')}` : ''}\n        icon={icons.bus}\n        loading={false}\n      >\n        {this.state.fetching ? (\n          <img src={loading} alt=\"fetching\" className=\"small-icon right-top spinning\" />\n        ) : (\n          <button className=\"icon-button right-top\" onClick={this.onStatusChange}>\n            <img\n              src={this.state.paused ? play : pause}\n              alt={this.state.paused ? 'play' : 'pause'}\n              className=\"small-icon\"\n            />\n          </button>\n        )}\n        {helper.iPhone && <a href=\"alipayqr://platformapi/startapp?saId=200011235\" target=\"_blank\" className=\"icon-button left-top\">\n          <img src={wallet} alt=\"wallet\" className=\"small-icon\" />\n        </a>}\n      </Card>\n    );\n  }\n}\n\nexport default Bus;\n","import { icons } from '../cards/Section';\n\nfunction mapWeatherIcon(weatherId: number) {\n  if (weatherId >= 200 && weatherId <= 232) {\n    return icons.thunderstorm;\n  } else if (weatherId >= 300 && weatherId <= 321) {\n    return icons.heavyRain;\n  } else if (weatherId >= 500 && weatherId <= 531) {\n    return icons.lightRain;\n  } else if (weatherId >= 600 && weatherId <= 622) {\n    return icons.snow;\n  } else if (weatherId === 800) {\n    return icons.clear;\n  } else if (weatherId >= 801 && weatherId <= 804) {\n    return icons.cloud;\n  }\n  return icons.clear;\n}\ninterface Weather {\n  clouds: number;\n  deg: number;\n  dt: number;\n  humidity: number;\n  pressure: number;\n  speed: number;\n  temp: {\n    day: number;\n    min: number;\n    max: number;\n    night: number;\n    eve: number;\n    morn: number;\n  };\n  weather: Array<{\n    id: number;\n    main: string;\n    icon: string;\n    description: string;\n  }>;\n}\n\ninterface WeatherResponse {\n  city: {\n    id: number;\n    name: string;\n    coord: {\n      lon: number;\n      lat: number;\n    };\n    country: string;\n    population: number;\n  };\n  cnt: number;\n  cod: string;\n  message: number;\n  list: Array<Weather>\n}\n\nexport default async function getWeatherDetails() {\n  // Hit the weather API\n  const weatherApiUrl = 'https://api.openweathermap.org/data/2.5/forecast/daily?lat=30.29365&lon=120.16142&units=metric&cnt=1&appid=d94bcd435b62a031771c35633f9f310a';\n  const response = await fetch(weatherApiUrl);\n  const weatherResult: WeatherResponse = await response.json();\n\n  // Update the tempature\n  const weatherTemperature = weatherResult.list[0].temp;\n  return {\n    temperature: weatherTemperature,    \n    icon: mapWeatherIcon(weatherResult.list[0].weather[0].id),\n    rainy: weatherResult.list[0].weather.some(({ id }) => {\n      const icon = mapWeatherIcon(id);\n      return icon === icons.lightRain || icon === icons.heavyRain;\n    }),\n  };\n}\n","interface Air {\n  aqi: number;\n  attributions: Array<{\n    url: string;\n    name: string;\n  }>;\n  city: {\n    geo: [number, number];\n    name: string;\n    url: string;\n  };\n  debug: {\n    sync: string;\n  };\n  dominentpol: string;\n  iaqi: {\n    co: { v: number };\n    no2: { v: number };\n    o3: { v: number };\n    pm10: { v: number };\n    pm25: { v: number };\n    so2: { v: number };\n    w: { v: number };\n  };\n  idx: number;\n  time: {\n    v: number;\n  };\n}\n\ninterface AirResponse {\n  status: 'ok';\n  data: Air;\n}\n\nexport default async function getAirDetails() {\n  // http://aqicn.org/city/zhejiang/hangzhoushi/chaohuiwuqu/ to get @722\n  const url = 'https://api.waqi.info/feed/@722/?token=877232d674043e76c5ea9037b8772e1aa4dbd702';\n  const response = await fetch(url);\n  const json: AirResponse = await response.json();\n  return json.data;\n}\n","import React, { PureComponent } from 'react';\nimport Card from './Card';\nimport { icons } from './Section';\nimport umbrella from '../img/umbrella.svg';\nimport mask from '../img/mask.svg';\nimport getWeatherDetails from '../utils/weather';\nimport getAirDetails from '../utils/air';\nimport * as helper from '../utils/helper';\n\nclass Weather extends PureComponent {\n  state = {\n    weather: {\n      loading: true,\n      title: '',\n      subtitle: '',\n      rainy: false,\n      icon: icons.clear,\n    },\n    air: {\n      loading: true,\n      aqi: 0,\n    },\n  };\n  async getWeather() {\n    const details = await getWeatherDetails();\n\n    this.setState({\n      weather: {\n        loading: false,\n        title: helper.isMorning() ? details.temperature.morn : details.temperature.eve + ' ° C',\n        subtitle: `${details.temperature.night} ~ ${details.temperature.day}  ° C`,\n        rainy: details.rainy,\n        icon: details.icon,\n      },\n    });\n  }\n  async getAir() {\n    const details = await getAirDetails();\n    this.setState({\n      air: {\n        loading: false,\n        aqi: details.aqi,\n      },\n    });\n  }\n  componentDidMount() {\n    this.getWeather();\n    this.getAir();\n  }\n  render() {\n    return (\n      <Card\n        color=\"#38c9ba\"\n        {...this.state.weather}\n      >\n        {this.state.weather.rainy && (\n          <img src={umbrella} alt=\"bring umbrella\" className=\"small-icon left-bottom\" />\n        )}\n        {!this.state.air.loading && (\n          <div className=\"right-bottom\">\n            {Array.from({ length: Math.floor(this.state.air.aqi / 50) }).map((_, i) => (\n              <img src={mask} alt=\"air condition icon\" className=\"small-icon\" key={i} />\n            ))}\n          </div>\n        )}\n      </Card>\n    );\n  }\n}\n\nexport default Weather;\n","interface BilibiliVideo {\n  cover: string;\n  delay: number;\n  ep_id: number;\n  favorites: number;\n  follow: number;\n  is_published: 0 | 1;\n  pub_index: string;\n  pub_time: string;\n  pub_ts: number;\n  season_id: number;\n  season_status: number;\n  square_cover: string;\n  title: string;\n}\n\ninterface BilibiliVideosInDay {\n  date: string;\n  date_ts: number;\n  day_of_week: number;\n  is_today: 0 | 1;\n  seasons: Array<BilibiliVideo>;\n}\n\ninterface BilibiliTimelineResponse {\n  code: number;\n  message: 'success';\n  result: Array<BilibiliVideosInDay>;\n}\n\nexport interface VideoDetails {\n  date: number;\n  episode: string;\n  title: string;\n  seasonId: number;\n  id: number;\n  episodeNum: number;\n}\n\nasync function fetchBilibili() {\n  const response = await fetch('https://cors-anywhere.herokuapp.com/http://bangumi.bilibili.com/web_api/timeline_global');\n  const json: BilibiliTimelineResponse = await response.json();\n  return json;\n}\n\nexport async function getBilibiliDetails() {\n  const { result } = await fetchBilibili();\n  const index = result.findIndex(day => day.is_today === 1);\n  const daysUntilToday = result.slice(0, index + 1);\n  const daysFromToday = result.slice(index);\n  const firstDayWithUnpublishedVideo =\n    daysFromToday.find(day => day.seasons.findIndex(season => season.is_published === 0) >= 0);\n  const videos: Array<VideoDetails> = daysUntilToday\n    .map((day) => day.seasons\n      .filter(season => season.is_published === 1)\n      .map(season => {\n        const episode = season.pub_index;\n        const matched = /第([\\d.]+)话/.exec(episode);\n        let episodeNum = 0;\n        if (matched) {\n          episodeNum = +matched[1];\n        }\n        return {\n          date: season.pub_ts * 1000,\n          episode,\n          title: season.title,\n          seasonId: season.season_id,\n          id: season.ep_id,\n          episodeNum,\n        };\n      })\n    )\n    .reduce((acc, day) => acc.concat(day), []);\n  let nextUpdateTime = 0;\n  if (firstDayWithUnpublishedVideo) {\n    const first = firstDayWithUnpublishedVideo.seasons.find(season => season.is_published === 0) as BilibiliVideo;\n    nextUpdateTime = first.pub_ts * 1000;\n  }\n  return {\n    videos,\n    nextUpdateTime,\n  };\n}","import React, { PureComponent } from 'react';\nimport Card, { icons } from './Card';\nimport { getBilibiliDetails, VideoDetails } from '../utils/video';\nimport * as helper from '../utils/helper';\nimport left from '../img/left.svg';\nimport right from '../img/right.svg';\nimport check from '../img/check.svg';\n\nfunction getWatchList() {\n  return import('../config'/* webpackChunkName: 'config' */).then(config => config.default.video);\n}\n\nclass Video extends PureComponent {\n  state: { watchList: Array<VideoDetails>, index: number } = {\n    watchList: [],\n    index: 0,\n  }\n  async getPendingWatchList() {\n    const cachedDetails: {\n      nextUpdateTime: number;\n      videos: Array<VideoDetails>;\n    } = JSON.parse(localStorage.getItem('bilibili-videos') || '{\"nextUpdateTime\":0,\"videos\":[]}');\n    const shouldUpdate = cachedDetails.nextUpdateTime < Date.now();\n    const [playlist, details] = await Promise.all([\n      getWatchList(),\n      shouldUpdate ? getBilibiliDetails() : Promise.resolve(cachedDetails),\n    ]);\n    const { videos } = details;\n    if (shouldUpdate) {\n      localStorage.setItem('bilibili-videos', JSON.stringify(details));\n    }\n    const watched = JSON.parse(localStorage.getItem('bilibili') || '{}');\n    const unwatched = videos\n    .filter((video) => {\n      const season = video.seasonId;\n      return playlist.bilibili.indexOf(season) >= 0;\n    })\n    .filter((video) => {\n      const season = video.seasonId;\n      const lastWatchedEpisode = watched[season] || 0;\n      return lastWatchedEpisode < video.episodeNum;\n    })\n    .sort((videoA, videoB) => {\n      const isVideoAToday = helper.isToday(new Date(videoA.date));\n      const isVideoBToday = helper.isToday(new Date(videoB.date));\n      if (isVideoAToday && !isVideoBToday) return -1;\n      if (!isVideoAToday && isVideoBToday) return 1;\n      const videoAIndex = playlist.bilibili.indexOf(videoA.seasonId);\n      const videoBIndex = playlist.bilibili.indexOf(videoB.seasonId);\n      if (videoAIndex < videoBIndex) return -1;\n      if (videoAIndex > videoBIndex) return 1;\n      return videoA.episode > videoB.episode ? 1 : -1;\n    });\n\n    this.setState({ watchList: unwatched, index: 0 });\n  }\n  onNext = () => {\n    this.setState({\n      index: this.state.index + 1,\n    });\n  }\n  onPrevious = () => {\n    this.setState({\n      index: this.state.index - 1,\n    });\n  }\n  onWatched = () => {\n    const watched: any = JSON.parse(localStorage.getItem('bilibili') || '{}');\n    const video = this.state.watchList[this.state.index];\n    watched[video.seasonId] = video.episodeNum;\n    localStorage.setItem('bilibili', JSON.stringify(watched));\n    this.getPendingWatchList();\n  }\n  componentDidMount() {\n    this.getPendingWatchList(); \n  }\n  render() {\n    const video = this.state.watchList[this.state.index];\n    const hasUnwatched = !!video;\n    const hasPrevious = this.state.index > 0;\n    const hasNext = this.state.index < this.state.watchList.length - 1;\n    return (\n      <Card\n        color=\"#6994e3\"\n        title={hasUnwatched ? 'Bilibili' : '-'}\n        subtitle={hasUnwatched ? video.title : ''}\n        icon={icons.video}\n        loading={false}\n        link={hasUnwatched ? `https://m.bilibili.com/bangumi/play/ep${video.id}` : undefined}\n      >\n        {hasPrevious && (\n          <button className=\"icon-button left-top\" onClick={this.onPrevious}>\n            <img src={left} alt=\"previous\" className=\"small-icon\" />\n          </button>\n        )}\n        {hasNext && (\n          <button className=\"icon-button right-top\" onClick={this.onNext}>\n            <img src={right} alt=\"next\" className=\"small-icon\" />\n          </button>\n        )}\n        <button className=\"icon-button left-bottom\" onClick={this.onWatched}>\n          <img src={check} alt=\"set watched\" className=\"small-icon\" />\n        </button>\n        <span className=\"right-bottom\">{hasUnwatched ? video.episode : ''}</span>\n      </Card>\n    );\n  }\n}\n\nexport default Video;\n","import React, { PureComponent } from 'react';\nimport Card, { icons } from './Card';\nimport * as helper from '../utils/helper';\n\nfunction getEating() {\n  return import('../config' /* webpackChunkName */).then(config => config.default.eating);\n}\n\nclass Eating extends PureComponent {\n  state: { loading: boolean, eating: Array<{ name: string }> } = {\n    loading: true,\n    eating: [],\n  };\n  componentDidMount() {\n    this.update();\n  }\n  update = () => {\n    if (!this.state.loading) {\n      this.setState({\n        loading: true,\n      });\n    }\n    getEating().then((list) => {\n      const time = helper.getTime();\n      const weekday = (new Date()).getDay();\n      const filtered = list.filter((food) => {\n        if (typeof food.restrict === 'undefined') return true;\n        const restrict = food.restrict;\n        if (typeof restrict.day !== 'undefined' && restrict.day.indexOf(weekday) < 0) return false;\n        if (typeof restrict.meal !== 'undefined') {\n          if (restrict.meal === 'dinner') {\n            if (time !== helper.time.evening) return false;\n          } else if (restrict.meal === 'lunch') {\n            if (time !== helper.time.noon) return false;\n          }\n        }\n        return true;\n      });\n      this.setState({\n        eating: helper.weightedSampling(filtered, 5),\n        loading: false,\n      });\n    });\n  }\n  render() {\n    const [first, ...rest] = this.state.eating;\n    return (\n      <Card\n        color=\"#cc5c75\"\n        title={first && first.name}\n        subtitle={first && rest.map(food => food.name).join('/')}\n        icon={icons.eating}\n        loading={this.state.loading}\n      />\n    )\n  }\n}\n\nexport default Eating;\n","import React, { PureComponent } from 'react';\nimport './App.css';\nimport Bus from './cards/Bus';\nimport Weather from './cards/Weather';\nimport Video from './cards/Video';\nimport Eating from './cards/Eating';\nimport { time, getTime } from './utils/helper';\n\nclass App extends PureComponent {\n  state: { time: time };\n  constructor(props: any) {\n    super(props);\n    this.state = {\n      time: getTime(),\n    };\n  }\n  updateTime = () => {\n    if (!document.hidden) {\n      this.setState({ time: getTime() });\n    }\n  }\n  componentDidMount() {\n    document.addEventListener('visibilitychange', this.updateTime, false);\n  }\n  componentWillUnmount() {\n    document.removeEventListener('visibilitychange', this.updateTime);\n  }\n  render() {\n    let children: Array<any> = [];\n    switch (this.state.time) {\n      case time.morning:\n        children = [Weather, Bus, Video, Eating];\n        break;\n      case time.noon:\n        children = [Eating, Video, Weather, Bus];\n        break;\n      case time.afternoon:\n        children = [Weather, Video, Eating, Bus];\n        break;\n      case time.evening:\n        children = [Eating, Bus, Video, Weather];\n        break;\n      case time.night:\n        children = [Video, Weather, Bus, Eating];\n        break;\n    }\n    return (\n      <main className=\"app\">\n        {children.map(child => React.createElement(child, { key: child.name }))}\n      </main>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.register();\n"],"sourceRoot":""}